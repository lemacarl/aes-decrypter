{"version":3,"sources":["main.min.js","main.js"],"names":["displayToast","message","M","toast","html","decryptFile","file","password","reader","FileReader","inputType","document","querySelector","value","readAsArrayBuffer","readAsText","onload","e","pass","CryptoJS","enc","Utf8","parse","cipherText","lib","WordArray","create","target","result","decrypted","getDecryptedOutput","type","output","filterOutput","blob","Blob","blobUrl","URL","createObjectURL","download","name","url","anchor","getElementById","href","click","args","AES","decrypt","ciphertext","iv","mode","CBC","padding","pad","Pkcs7","reorganizeHexValues","toString","Hex","Base64","values","columnCount","i","length","isLocalhost","Boolean","window","location","hostname","match","navigator","protocol","serviceWorker","register","then","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","Error","console","error","fileUpload","fileName","btnDecrypt","addEventListener","files","preventDefault"],"mappings":"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","file":"main.min.js","sourcesContent":["'use strict'; /*!\n               *\n               *  AES Decrypter\n               *\n               *  Licensed under the Apache License, Version 2.0 (the \"License\");\n               *  you may not use this file except in compliance with the License.\n               *  You may obtain a copy of the License at\n               *\n               *    https://www.apache.org/licenses/LICENSE-2.0\n               *\n               *  Unless required by applicable law or agreed to in writing, software\n               *  distributed under the License is distributed on an \"AS IS\" BASIS,\n               *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n               *  See the License for the specific language governing permissions and\n               *  limitations under the License\n               *\n               */\n/* eslint-env browser */\n\n/**\n                          * Display toast using Materialize\n                          * @param {*} message Toast message\n                          */\nfunction displayToast(message) {\n  M.toast({\n    html: message });\n\n}\n\n/**\n   * Decrypt file using CryptoJS\n   * @param {*} file File object\n   * @param {*} password Password\n   */\nfunction decryptFile(file, password) {\n  var reader = new FileReader();\n  var inputType = document.\n  querySelector('input[name=\"input-type\"]:checked').\n  value;\n\n  // Change reader method based on input type\n  if ('hex' === inputType) {\n    reader.readAsArrayBuffer(file);\n  } else {\n    reader.readAsText(file);\n  }\n  reader.onload = function (e) {\n    var pass = CryptoJS.enc.Utf8.parse(password);\n    var cipherText = void 0;\n\n    // Render cipher text based on input type\n    if ('hex' === inputType) {\n      cipherText = CryptoJS.lib.WordArray.create(e.target.result);\n    } else {\n      cipherText = e.target.result;\n    }\n\n    // Decrypted file\n    var decrypted = getDecryptedOutput({\n      cipherText: cipherText,\n      pass: pass,\n      type: inputType });\n\n\n    // Filter output based on input type\n    var output = filterOutput(decrypted, inputType);\n    var blob = new Blob([output], {\n      type: 'application/octet-stream' });\n\n\n    var blobUrl = URL.createObjectURL(blob);\n    download(file.name, blobUrl);\n  };\n}\n\n/**\n   * Trigger file download\n   * @param {String} name File name\n   * @param {String} url URL\n   */\nfunction download(name, url) {\n  var anchor = document.getElementById('download');\n  anchor.href = url;\n  anchor.download = name;\n  anchor.click();\n}\n\n/**\n   * Decrypt cipher text\n   * @param {*} args Object with arguments\n   * @return {*} Object\n   */\nfunction getDecryptedOutput(args) {\n  var decrypted = void 0;\n  if ('hex' === args.type) {\n    decrypted = CryptoJS.AES.decrypt({\n      ciphertext: args.cipherText },\n\n    args.pass, {\n      iv: args.pass,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7 });\n\n  } else {\n    decrypted = CryptoJS.AES.decrypt(args.cipherText, args.pass, {\n      iv: args.pass,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7 });\n\n  }\n  return decrypted;\n}\n\n/**\n   * Filter output based on type\n   * @param {*} decrypted Decryptor\n   * @param {*} type Input type\n   * @return {*} String\n   */\nfunction filterOutput(decrypted, type) {\n  var output = void 0;\n  switch (type) {\n    case 'hex':\n      output = reorganizeHexValues(decrypted.toString(CryptoJS.enc.Hex));\n      break;\n    case 'b64':\n      output = decrypted.toString(CryptoJS.enc.Base64);\n      break;\n    case 'utf-8':\n      output = decrypted.toString(CryptoJS.enc.Utf8);\n      break;\n    default:\n      output = decrypted.toString();}\n\n  return output;\n}\n\n/**\n   * Reorganize hex values to correct format\n   * @param {String} values String\n   * @return {String} organized hex values\n   */\nfunction reorganizeHexValues(values) {\n  var output = '';\n  var columnCount = 0;\n  for (var i = 0; i < values.length; i += 4) {\n    columnCount++;\n    output += values[i] + values[i + 1] + values[i + 2] + values[i + 3];\n    if (columnCount === 8) {\n      columnCount = 0;\n      output += '\\n';\n    } else {\n      output += ' ';\n    }\n  }\n  return output;\n}\n\n(function () {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.1/8 is considered localhost for IPv4.\n  window.location.hostname.match(\n  /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));\n\n\n\n  if ('serviceWorker' in navigator && (\n  window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js').\n    then(function (registration) {\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function () {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          var installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function () {\n            switch (installingWorker.state) {\n              case 'installed':\n                // At this point, the old content will have been purged and the\n                // fresh content will have been added to the cache.\n                // It's the perfect time to display a \"New content is\n                // available; please refresh.\" message in the page's interface.\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' +\n                'service worker became redundant.');\n\n              default:\n              // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function (e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n  var fileUpload = document.getElementById('file-upload');\n  var fileName = document.getElementById('file-name');\n  var password = document.getElementById('password');\n  var btnDecrypt = document.getElementById('btn-decrypt');\n\n  fileUpload.addEventListener('change', function () {\n    fileName.value = fileUpload.files[0].name;\n  });\n\n  btnDecrypt.addEventListener('click', function (e) {\n    e.preventDefault();\n\n    if (!fileUpload.files[0]) {\n      displayToast('Please select a file.');\n      return;\n    }\n    if (!password.value) {\n      displayToast('Please enter a password.');\n      return;\n    }\n    var file = fileUpload.files[0];\n    fileName.value = file.name;\n\n    decryptFile(file, password.value);\n  });\n})();\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZGlzcGxheVRvYXN0IiwibWVzc2FnZSIsIk0iLCJ0b2FzdCIsImh0bWwiLCJkZWNyeXB0RmlsZSIsImZpbGUiLCJwYXNzd29yZCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJpbnB1dFR5cGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ2YWx1ZSIsInJlYWRBc0FycmF5QnVmZmVyIiwicmVhZEFzVGV4dCIsIm9ubG9hZCIsInBhc3MiLCJDcnlwdG9KUyIsImVuYyIsIlV0ZjgiLCJwYXJzZSIsImNpcGhlclRleHQiLCJsaWIiLCJXb3JkQXJyYXkiLCJjcmVhdGUiLCJlIiwidGFyZ2V0IiwicmVzdWx0IiwiZGVjcnlwdGVkIiwiZ2V0RGVjcnlwdGVkT3V0cHV0IiwidHlwZSIsIm91dHB1dCIsImZpbHRlck91dHB1dCIsImJsb2IiLCJCbG9iIiwiYmxvYlVybCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImRvd25sb2FkIiwibmFtZSIsInVybCIsImFuY2hvciIsImdldEVsZW1lbnRCeUlkIiwiaHJlZiIsImNsaWNrIiwiYXJncyIsIkFFUyIsImRlY3J5cHQiLCJjaXBoZXJ0ZXh0IiwiaXYiLCJtb2RlIiwiQ0JDIiwicGFkZGluZyIsInBhZCIsIlBrY3M3IiwicmVvcmdhbml6ZUhleFZhbHVlcyIsInRvU3RyaW5nIiwiSGV4IiwiQmFzZTY0IiwidmFsdWVzIiwiY29sdW1uQ291bnQiLCJpIiwibGVuZ3RoIiwiaXNMb2NhbGhvc3QiLCJCb29sZWFuIiwid2luZG93IiwibG9jYXRpb24iLCJob3N0bmFtZSIsIm1hdGNoIiwibmF2aWdhdG9yIiwicHJvdG9jb2wiLCJzZXJ2aWNlV29ya2VyIiwicmVnaXN0ZXIiLCJ0aGVuIiwicmVnaXN0cmF0aW9uIiwib251cGRhdGVmb3VuZCIsImNvbnRyb2xsZXIiLCJpbnN0YWxsaW5nV29ya2VyIiwiaW5zdGFsbGluZyIsIm9uc3RhdGVjaGFuZ2UiLCJzdGF0ZSIsIkVycm9yIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaWxlVXBsb2FkIiwiZmlsZU5hbWUiLCJidG5EZWNyeXB0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImZpbGVzIiwicHJldmVudERlZmF1bHQiXSwibWFwcGluZ3MiOiJjQUFBOzs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQTs7QUFFQTs7OztBQUlBLFNBQVNBLFlBQVQsQ0FBc0JDLE9BQXRCLEVBQStCO0FBQzdCQyxJQUFFQyxLQUFGLENBQVE7QUFDTkMsVUFBTUgsT0FEQSxFQUFSOztBQUdEOztBQUVEOzs7OztBQUtBLFNBQVNJLFdBQVQsQ0FBcUJDLElBQXJCLEVBQTJCQyxRQUEzQixFQUFxQztBQUNuQyxNQUFNQyxTQUFTLElBQUlDLFVBQUosRUFBZjtBQUNBLE1BQU1DLFlBQVlDO0FBQ2ZDLGVBRGUsQ0FDRCxrQ0FEQztBQUVmQyxPQUZIOztBQUlBO0FBQ0EsTUFBSSxVQUFVSCxTQUFkLEVBQXlCO0FBQ3ZCRixXQUFPTSxpQkFBUCxDQUF5QlIsSUFBekI7QUFDRCxHQUZELE1BRU87QUFDTEUsV0FBT08sVUFBUCxDQUFrQlQsSUFBbEI7QUFDRDtBQUNERSxTQUFPUSxNQUFQLEdBQWdCLGFBQUs7QUFDbkIsUUFBTUMsT0FBT0MsU0FBU0MsR0FBVCxDQUFhQyxJQUFiLENBQWtCQyxLQUFsQixDQUF3QmQsUUFBeEIsQ0FBYjtBQUNBLFFBQUllLG1CQUFKOztBQUVBO0FBQ0EsUUFBSSxVQUFVWixTQUFkLEVBQXlCO0FBQ3ZCWSxtQkFBYUosU0FBU0ssR0FBVCxDQUFhQyxTQUFiLENBQXVCQyxNQUF2QixDQUE4QkMsRUFBRUMsTUFBRixDQUFTQyxNQUF2QyxDQUFiO0FBQ0QsS0FGRCxNQUVPO0FBQ0xOLG1CQUFhSSxFQUFFQyxNQUFGLENBQVNDLE1BQXRCO0FBQ0Q7O0FBRUQ7QUFDQSxRQUFJQyxZQUFZQyxtQkFBbUI7QUFDakNSLGtCQUFZQSxVQURxQjtBQUVqQ0wsWUFBTUEsSUFGMkI7QUFHakNjLFlBQU1yQixTQUgyQixFQUFuQixDQUFoQjs7O0FBTUE7QUFDQSxRQUFJc0IsU0FBU0MsYUFBYUosU0FBYixFQUF3Qm5CLFNBQXhCLENBQWI7QUFDQSxRQUFNd0IsT0FBTyxJQUFJQyxJQUFKLENBQVMsQ0FBQ0gsTUFBRCxDQUFULEVBQW1CO0FBQzlCRCxZQUFNLDBCQUR3QixFQUFuQixDQUFiOzs7QUFJQSxRQUFJSyxVQUFVQyxJQUFJQyxlQUFKLENBQW9CSixJQUFwQixDQUFkO0FBQ0FLLGFBQVNqQyxLQUFLa0MsSUFBZCxFQUFvQkosT0FBcEI7QUFDRCxHQTFCRDtBQTJCRDs7QUFFRDs7Ozs7QUFLQSxTQUFTRyxRQUFULENBQWtCQyxJQUFsQixFQUF3QkMsR0FBeEIsRUFBNkI7QUFDM0IsTUFBTUMsU0FBUy9CLFNBQVNnQyxjQUFULENBQXdCLFVBQXhCLENBQWY7QUFDQUQsU0FBT0UsSUFBUCxHQUFjSCxHQUFkO0FBQ0FDLFNBQU9ILFFBQVAsR0FBa0JDLElBQWxCO0FBQ0FFLFNBQU9HLEtBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTZixrQkFBVCxDQUE0QmdCLElBQTVCLEVBQWtDO0FBQ2hDLE1BQUlqQixrQkFBSjtBQUNBLE1BQUksVUFBVWlCLEtBQUtmLElBQW5CLEVBQXlCO0FBQ3ZCRixnQkFBWVgsU0FBUzZCLEdBQVQsQ0FBYUMsT0FBYixDQUFxQjtBQUMvQkMsa0JBQVlILEtBQUt4QixVQURjLEVBQXJCOztBQUdad0IsU0FBSzdCLElBSE8sRUFHRDtBQUNUaUMsVUFBSUosS0FBSzdCLElBREE7QUFFVGtDLFlBQU1qQyxTQUFTaUMsSUFBVCxDQUFjQyxHQUZYO0FBR1RDLGVBQVNuQyxTQUFTb0MsR0FBVCxDQUFhQyxLQUhiLEVBSEMsQ0FBWjs7QUFRRCxHQVRELE1BU087QUFDTDFCLGdCQUFZWCxTQUFTNkIsR0FBVCxDQUFhQyxPQUFiLENBQXFCRixLQUFLeEIsVUFBMUIsRUFBc0N3QixLQUFLN0IsSUFBM0MsRUFBaUQ7QUFDM0RpQyxVQUFJSixLQUFLN0IsSUFEa0Q7QUFFM0RrQyxZQUFNakMsU0FBU2lDLElBQVQsQ0FBY0MsR0FGdUM7QUFHM0RDLGVBQVNuQyxTQUFTb0MsR0FBVCxDQUFhQyxLQUhxQyxFQUFqRCxDQUFaOztBQUtEO0FBQ0QsU0FBTzFCLFNBQVA7QUFDRDs7QUFFRDs7Ozs7O0FBTUEsU0FBU0ksWUFBVCxDQUFzQkosU0FBdEIsRUFBaUNFLElBQWpDLEVBQXVDO0FBQ3JDLE1BQUlDLGVBQUo7QUFDQSxVQUFRRCxJQUFSO0FBQ0UsU0FBSyxLQUFMO0FBQ0VDLGVBQVN3QixvQkFBb0IzQixVQUFVNEIsUUFBVixDQUFtQnZDLFNBQVNDLEdBQVQsQ0FBYXVDLEdBQWhDLENBQXBCLENBQVQ7QUFDQTtBQUNGLFNBQUssS0FBTDtBQUNFMUIsZUFBU0gsVUFBVTRCLFFBQVYsQ0FBbUJ2QyxTQUFTQyxHQUFULENBQWF3QyxNQUFoQyxDQUFUO0FBQ0E7QUFDRixTQUFLLE9BQUw7QUFDRTNCLGVBQVNILFVBQVU0QixRQUFWLENBQW1CdkMsU0FBU0MsR0FBVCxDQUFhQyxJQUFoQyxDQUFUO0FBQ0E7QUFDRjtBQUNFWSxlQUFTSCxVQUFVNEIsUUFBVixFQUFULENBWEo7O0FBYUEsU0FBT3pCLE1BQVA7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTd0IsbUJBQVQsQ0FBNkJJLE1BQTdCLEVBQXFDO0FBQ25DLE1BQUk1QixTQUFTLEVBQWI7QUFDQSxNQUFJNkIsY0FBYyxDQUFsQjtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJRixPQUFPRyxNQUEzQixFQUFtQ0QsS0FBSyxDQUF4QyxFQUEyQztBQUN6Q0Q7QUFDQTdCLGNBQVU0QixPQUFPRSxDQUFQLElBQVlGLE9BQU9FLElBQUksQ0FBWCxDQUFaLEdBQTRCRixPQUFPRSxJQUFJLENBQVgsQ0FBNUIsR0FBNENGLE9BQU9FLElBQUksQ0FBWCxDQUF0RDtBQUNBLFFBQUlELGdCQUFnQixDQUFwQixFQUF1QjtBQUNyQkEsb0JBQWMsQ0FBZDtBQUNBN0IsZ0JBQVUsSUFBVjtBQUNELEtBSEQsTUFHTztBQUNMQSxnQkFBVSxHQUFWO0FBQ0Q7QUFDRjtBQUNELFNBQU9BLE1BQVA7QUFDRDs7QUFFRCxDQUFDLFlBQVc7QUFDVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUlnQyxjQUFjQyxRQUFRQyxPQUFPQyxRQUFQLENBQWdCQyxRQUFoQixLQUE2QixXQUE3QjtBQUN0QjtBQUNBRixTQUFPQyxRQUFQLENBQWdCQyxRQUFoQixLQUE2QixPQUZQO0FBR3RCO0FBQ0FGLFNBQU9DLFFBQVAsQ0FBZ0JDLFFBQWhCLENBQXlCQyxLQUF6QjtBQUNFLDBEQURGLENBSmMsQ0FBbEI7Ozs7QUFTQSxNQUFJLG1CQUFtQkMsU0FBbkI7QUFDQ0osU0FBT0MsUUFBUCxDQUFnQkksUUFBaEIsS0FBNkIsUUFBN0IsSUFBeUNQLFdBRDFDLENBQUosRUFDNEQ7QUFDMURNLGNBQVVFLGFBQVYsQ0FBd0JDLFFBQXhCLENBQWlDLG1CQUFqQztBQUNDQyxRQURELENBQ00sVUFBU0MsWUFBVCxFQUF1QjtBQUMzQjtBQUNBQSxtQkFBYUMsYUFBYixHQUE2QixZQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBSU4sVUFBVUUsYUFBVixDQUF3QkssVUFBNUIsRUFBd0M7QUFDdEM7QUFDQTtBQUNBLGNBQUlDLG1CQUFtQkgsYUFBYUksVUFBcEM7O0FBRUFELDJCQUFpQkUsYUFBakIsR0FBaUMsWUFBVztBQUMxQyxvQkFBUUYsaUJBQWlCRyxLQUF6QjtBQUNFLG1CQUFLLFdBQUw7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVGLG1CQUFLLFdBQUw7QUFDRSxzQkFBTSxJQUFJQyxLQUFKLENBQVU7QUFDQSxrREFEVixDQUFOOztBQUdGO0FBQ0U7QUFiSjtBQWVELFdBaEJEO0FBaUJEO0FBQ0YsT0E1QkQ7QUE2QkQsS0FoQ0QsRUFnQ0dDLEtBaENILENBZ0NTLFVBQVN6RCxDQUFULEVBQVk7QUFDbkIwRCxjQUFRQyxLQUFSLENBQWMsMkNBQWQsRUFBMkQzRCxDQUEzRDtBQUNELEtBbENEO0FBbUNEOztBQUVEO0FBQ0EsTUFBTTRELGFBQWEzRSxTQUFTZ0MsY0FBVCxDQUF3QixhQUF4QixDQUFuQjtBQUNBLE1BQU00QyxXQUFXNUUsU0FBU2dDLGNBQVQsQ0FBd0IsV0FBeEIsQ0FBakI7QUFDQSxNQUFNcEMsV0FBV0ksU0FBU2dDLGNBQVQsQ0FBd0IsVUFBeEIsQ0FBakI7QUFDQSxNQUFNNkMsYUFBYTdFLFNBQVNnQyxjQUFULENBQXdCLGFBQXhCLENBQW5COztBQUVBMkMsYUFBV0csZ0JBQVgsQ0FBNEIsUUFBNUIsRUFBc0MsWUFBTTtBQUMxQ0YsYUFBUzFFLEtBQVQsR0FBaUJ5RSxXQUFXSSxLQUFYLENBQWlCLENBQWpCLEVBQW9CbEQsSUFBckM7QUFDRCxHQUZEOztBQUlBZ0QsYUFBV0MsZ0JBQVgsQ0FBNEIsT0FBNUIsRUFBcUMsYUFBSztBQUN4Qy9ELE1BQUVpRSxjQUFGOztBQUVBLFFBQUksQ0FBQ0wsV0FBV0ksS0FBWCxDQUFpQixDQUFqQixDQUFMLEVBQTBCO0FBQ3hCMUYsbUJBQWEsdUJBQWI7QUFDQTtBQUNEO0FBQ0QsUUFBSSxDQUFDTyxTQUFTTSxLQUFkLEVBQXFCO0FBQ25CYixtQkFBYSwwQkFBYjtBQUNBO0FBQ0Q7QUFDRCxRQUFNTSxPQUFPZ0YsV0FBV0ksS0FBWCxDQUFpQixDQUFqQixDQUFiO0FBQ0FILGFBQVMxRSxLQUFULEdBQWlCUCxLQUFLa0MsSUFBdEI7O0FBRUFuQyxnQkFBWUMsSUFBWixFQUFrQkMsU0FBU00sS0FBM0I7QUFDRCxHQWZEO0FBZ0JELENBakZEIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqXG4gKiAgQUVTIERlY3J5cHRlclxuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICBodHRwczovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiAgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlXG4gKlxuICovXG4vKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cblxuLyoqXG4gKiBEaXNwbGF5IHRvYXN0IHVzaW5nIE1hdGVyaWFsaXplXG4gKiBAcGFyYW0geyp9IG1lc3NhZ2UgVG9hc3QgbWVzc2FnZVxuICovXG5mdW5jdGlvbiBkaXNwbGF5VG9hc3QobWVzc2FnZSkge1xuICBNLnRvYXN0KHtcbiAgICBodG1sOiBtZXNzYWdlXG4gIH0pO1xufVxuXG4vKipcbiAqIERlY3J5cHQgZmlsZSB1c2luZyBDcnlwdG9KU1xuICogQHBhcmFtIHsqfSBmaWxlIEZpbGUgb2JqZWN0XG4gKiBAcGFyYW0geyp9IHBhc3N3b3JkIFBhc3N3b3JkXG4gKi9cbmZ1bmN0aW9uIGRlY3J5cHRGaWxlKGZpbGUsIHBhc3N3b3JkKSB7XG4gIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gIGNvbnN0IGlucHV0VHlwZSA9IGRvY3VtZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJpbnB1dC10eXBlXCJdOmNoZWNrZWQnKVxuICAgIC52YWx1ZTtcblxuICAvLyBDaGFuZ2UgcmVhZGVyIG1ldGhvZCBiYXNlZCBvbiBpbnB1dCB0eXBlXG4gIGlmICgnaGV4JyA9PT0gaW5wdXRUeXBlKSB7XG4gICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpO1xuICB9IGVsc2Uge1xuICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xuICB9XG4gIHJlYWRlci5vbmxvYWQgPSBlID0+IHtcbiAgICBjb25zdCBwYXNzID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UocGFzc3dvcmQpO1xuICAgIGxldCBjaXBoZXJUZXh0O1xuXG4gICAgLy8gUmVuZGVyIGNpcGhlciB0ZXh0IGJhc2VkIG9uIGlucHV0IHR5cGVcbiAgICBpZiAoJ2hleCcgPT09IGlucHV0VHlwZSkge1xuICAgICAgY2lwaGVyVGV4dCA9IENyeXB0b0pTLmxpYi5Xb3JkQXJyYXkuY3JlYXRlKGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNpcGhlclRleHQgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgfVxuXG4gICAgLy8gRGVjcnlwdGVkIGZpbGVcbiAgICBsZXQgZGVjcnlwdGVkID0gZ2V0RGVjcnlwdGVkT3V0cHV0KHtcbiAgICAgIGNpcGhlclRleHQ6IGNpcGhlclRleHQsXG4gICAgICBwYXNzOiBwYXNzLFxuICAgICAgdHlwZTogaW5wdXRUeXBlXG4gICAgfSk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0cHV0IGJhc2VkIG9uIGlucHV0IHR5cGVcbiAgICBsZXQgb3V0cHV0ID0gZmlsdGVyT3V0cHV0KGRlY3J5cHRlZCwgaW5wdXRUeXBlKTtcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW291dHB1dF0sIHtcbiAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nXG4gICAgfSk7XG5cbiAgICBsZXQgYmxvYlVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgZG93bmxvYWQoZmlsZS5uYW1lLCBibG9iVXJsKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBUcmlnZ2VyIGZpbGUgZG93bmxvYWRcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIEZpbGUgbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IHVybCBVUkxcbiAqL1xuZnVuY3Rpb24gZG93bmxvYWQobmFtZSwgdXJsKSB7XG4gIGNvbnN0IGFuY2hvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb3dubG9hZCcpO1xuICBhbmNob3IuaHJlZiA9IHVybDtcbiAgYW5jaG9yLmRvd25sb2FkID0gbmFtZTtcbiAgYW5jaG9yLmNsaWNrKCk7XG59XG5cbi8qKlxuICogRGVjcnlwdCBjaXBoZXIgdGV4dFxuICogQHBhcmFtIHsqfSBhcmdzIE9iamVjdCB3aXRoIGFyZ3VtZW50c1xuICogQHJldHVybiB7Kn0gT2JqZWN0XG4gKi9cbmZ1bmN0aW9uIGdldERlY3J5cHRlZE91dHB1dChhcmdzKSB7XG4gIGxldCBkZWNyeXB0ZWQ7XG4gIGlmICgnaGV4JyA9PT0gYXJncy50eXBlKSB7XG4gICAgZGVjcnlwdGVkID0gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoe1xuICAgICAgY2lwaGVydGV4dDogYXJncy5jaXBoZXJUZXh0XG4gICAgfSxcbiAgICBhcmdzLnBhc3MsIHtcbiAgICAgIGl2OiBhcmdzLnBhc3MsXG4gICAgICBtb2RlOiBDcnlwdG9KUy5tb2RlLkNCQyxcbiAgICAgIHBhZGRpbmc6IENyeXB0b0pTLnBhZC5Qa2NzN1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGRlY3J5cHRlZCA9IENyeXB0b0pTLkFFUy5kZWNyeXB0KGFyZ3MuY2lwaGVyVGV4dCwgYXJncy5wYXNzLCB7XG4gICAgICBpdjogYXJncy5wYXNzLFxuICAgICAgbW9kZTogQ3J5cHRvSlMubW9kZS5DQkMsXG4gICAgICBwYWRkaW5nOiBDcnlwdG9KUy5wYWQuUGtjczdcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZGVjcnlwdGVkO1xufVxuXG4vKipcbiAqIEZpbHRlciBvdXRwdXQgYmFzZWQgb24gdHlwZVxuICogQHBhcmFtIHsqfSBkZWNyeXB0ZWQgRGVjcnlwdG9yXG4gKiBAcGFyYW0geyp9IHR5cGUgSW5wdXQgdHlwZVxuICogQHJldHVybiB7Kn0gU3RyaW5nXG4gKi9cbmZ1bmN0aW9uIGZpbHRlck91dHB1dChkZWNyeXB0ZWQsIHR5cGUpIHtcbiAgbGV0IG91dHB1dDtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnaGV4JzpcbiAgICAgIG91dHB1dCA9IHJlb3JnYW5pemVIZXhWYWx1ZXMoZGVjcnlwdGVkLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5IZXgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2I2NCc6XG4gICAgICBvdXRwdXQgPSBkZWNyeXB0ZWQudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLkJhc2U2NCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgICBvdXRwdXQgPSBkZWNyeXB0ZWQudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLlV0ZjgpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIG91dHB1dCA9IGRlY3J5cHRlZC50b1N0cmluZygpO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cbi8qKlxuICogUmVvcmdhbml6ZSBoZXggdmFsdWVzIHRvIGNvcnJlY3QgZm9ybWF0XG4gKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVzIFN0cmluZ1xuICogQHJldHVybiB7U3RyaW5nfSBvcmdhbml6ZWQgaGV4IHZhbHVlc1xuICovXG5mdW5jdGlvbiByZW9yZ2FuaXplSGV4VmFsdWVzKHZhbHVlcykge1xuICBsZXQgb3V0cHV0ID0gJyc7XG4gIGxldCBjb2x1bW5Db3VudCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSArPSA0KSB7XG4gICAgY29sdW1uQ291bnQrKztcbiAgICBvdXRwdXQgKz0gdmFsdWVzW2ldICsgdmFsdWVzW2kgKyAxXSArIHZhbHVlc1tpICsgMl0gKyB2YWx1ZXNbaSArIDNdO1xuICAgIGlmIChjb2x1bW5Db3VudCA9PT0gOCkge1xuICAgICAgY29sdW1uQ291bnQgPSAwO1xuICAgICAgb3V0cHV0ICs9ICdcXG4nO1xuICAgIH0gZWxzZSB7XG4gICAgICBvdXRwdXQgKz0gJyAnO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3V0cHV0O1xufVxuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBDaGVjayB0byBtYWtlIHN1cmUgc2VydmljZSB3b3JrZXJzIGFyZSBzdXBwb3J0ZWQgaW4gdGhlIGN1cnJlbnQgYnJvd3NlcixcbiAgLy8gYW5kIHRoYXQgdGhlIGN1cnJlbnQgcGFnZSBpcyBhY2Nlc3NlZCBmcm9tIGEgc2VjdXJlIG9yaWdpbi4gVXNpbmcgYVxuICAvLyBzZXJ2aWNlIHdvcmtlciBmcm9tIGFuIGluc2VjdXJlIG9yaWdpbiB3aWxsIHRyaWdnZXIgSlMgY29uc29sZSBlcnJvcnMuIFNlZVxuICAvLyBodHRwOi8vd3d3LmNocm9taXVtLm9yZy9Ib21lL2Nocm9taXVtLXNlY3VyaXR5L3ByZWZlci1zZWN1cmUtb3JpZ2lucy1mb3ItcG93ZXJmdWwtbmV3LWZlYXR1cmVzXG4gIHZhciBpc0xvY2FsaG9zdCA9IEJvb2xlYW4od2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyB8fFxuICAgICAgLy8gWzo6MV0gaXMgdGhlIElQdjYgbG9jYWxob3N0IGFkZHJlc3MuXG4gICAgICB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdbOjoxXScgfHxcbiAgICAgIC8vIDEyNy4wLjAuMS84IGlzIGNvbnNpZGVyZWQgbG9jYWxob3N0IGZvciBJUHY0LlxuICAgICAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLm1hdGNoKFxuICAgICAgICAvXjEyNyg/OlxcLig/OjI1WzAtNV18MlswLTRdWzAtOV18WzAxXT9bMC05XVswLTldPykpezN9JC9cbiAgICAgIClcbiAgICApO1xuXG4gIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yICYmXG4gICAgICAod2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyB8fCBpc0xvY2FsaG9zdCkpIHtcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc2VydmljZS13b3JrZXIuanMnKVxuICAgIC50aGVuKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbikge1xuICAgICAgLy8gdXBkYXRlZm91bmQgaXMgZmlyZWQgaWYgc2VydmljZS13b3JrZXIuanMgY2hhbmdlcy5cbiAgICAgIHJlZ2lzdHJhdGlvbi5vbnVwZGF0ZWZvdW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHVwZGF0ZWZvdW5kIGlzIGFsc28gZmlyZWQgdGhlIHZlcnkgZmlyc3QgdGltZSB0aGUgU1cgaXMgaW5zdGFsbGVkLFxuICAgICAgICAvLyBhbmQgdGhlcmUncyBubyBuZWVkIHRvIHByb21wdCBmb3IgYSByZWxvYWQgYXQgdGhhdCBwb2ludC5cbiAgICAgICAgLy8gU28gY2hlY2sgaGVyZSB0byBzZWUgaWYgdGhlIHBhZ2UgaXMgYWxyZWFkeSBjb250cm9sbGVkLFxuICAgICAgICAvLyBpLmUuIHdoZXRoZXIgdGhlcmUncyBhbiBleGlzdGluZyBzZXJ2aWNlIHdvcmtlci5cbiAgICAgICAgaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAvLyBUaGUgdXBkYXRlZm91bmQgZXZlbnQgaW1wbGllcyB0aGF0IHJlZ2lzdHJhdGlvbi5pbnN0YWxsaW5nIGlzIHNldDpcbiAgICAgICAgICAvLyBodHRwczovL3NsaWdodGx5b2ZmLmdpdGh1Yi5pby9TZXJ2aWNlV29ya2VyL3NwZWMvc2VydmljZV93b3JrZXIvaW5kZXguaHRtbCNzZXJ2aWNlLXdvcmtlci1jb250YWluZXItdXBkYXRlZm91bmQtZXZlbnRcbiAgICAgICAgICB2YXIgaW5zdGFsbGluZ1dvcmtlciA9IHJlZ2lzdHJhdGlvbi5pbnN0YWxsaW5nO1xuXG4gICAgICAgICAgaW5zdGFsbGluZ1dvcmtlci5vbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGluc3RhbGxpbmdXb3JrZXIuc3RhdGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAnaW5zdGFsbGVkJzpcbiAgICAgICAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50LCB0aGUgb2xkIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gcHVyZ2VkIGFuZCB0aGVcbiAgICAgICAgICAgICAgICAvLyBmcmVzaCBjb250ZW50IHdpbGwgaGF2ZSBiZWVuIGFkZGVkIHRvIHRoZSBjYWNoZS5cbiAgICAgICAgICAgICAgICAvLyBJdCdzIHRoZSBwZXJmZWN0IHRpbWUgdG8gZGlzcGxheSBhIFwiTmV3IGNvbnRlbnQgaXNcbiAgICAgICAgICAgICAgICAvLyBhdmFpbGFibGU7IHBsZWFzZSByZWZyZXNoLlwiIG1lc3NhZ2UgaW4gdGhlIHBhZ2UncyBpbnRlcmZhY2UuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAncmVkdW5kYW50JzpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBpbnN0YWxsaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2VydmljZSB3b3JrZXIgYmVjYW1lIHJlZHVuZGFudC4nKTtcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIC8vIElnbm9yZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIHNlcnZpY2Ugd29ya2VyIHJlZ2lzdHJhdGlvbjonLCBlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFlvdXIgY3VzdG9tIEphdmFTY3JpcHQgZ29lcyBoZXJlXG4gIGNvbnN0IGZpbGVVcGxvYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZS11cGxvYWQnKTtcbiAgY29uc3QgZmlsZU5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZS1uYW1lJyk7XG4gIGNvbnN0IHBhc3N3b3JkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkJyk7XG4gIGNvbnN0IGJ0bkRlY3J5cHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLWRlY3J5cHQnKTtcblxuICBmaWxlVXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICBmaWxlTmFtZS52YWx1ZSA9IGZpbGVVcGxvYWQuZmlsZXNbMF0ubmFtZTtcbiAgfSk7XG5cbiAgYnRuRGVjcnlwdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGlmICghZmlsZVVwbG9hZC5maWxlc1swXSkge1xuICAgICAgZGlzcGxheVRvYXN0KCdQbGVhc2Ugc2VsZWN0IGEgZmlsZS4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFwYXNzd29yZC52YWx1ZSkge1xuICAgICAgZGlzcGxheVRvYXN0KCdQbGVhc2UgZW50ZXIgYSBwYXNzd29yZC4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZmlsZSA9IGZpbGVVcGxvYWQuZmlsZXNbMF07XG4gICAgZmlsZU5hbWUudmFsdWUgPSBmaWxlLm5hbWU7XG5cbiAgICBkZWNyeXB0RmlsZShmaWxlLCBwYXNzd29yZC52YWx1ZSk7XG4gIH0pO1xufSkoKTtcbiJdfQ==\n","/*!\n *\n *  AES Decrypter\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n\n/**\n * Display toast using Materialize\n * @param {*} message Toast message\n */\nfunction displayToast(message) {\n  M.toast({\n    html: message\n  });\n}\n\n/**\n * Decrypt file using CryptoJS\n * @param {*} file File object\n * @param {*} password Password\n */\nfunction decryptFile(file, password) {\n  const reader = new FileReader();\n  const inputType = document\n    .querySelector('input[name=\"input-type\"]:checked')\n    .value;\n\n  // Change reader method based on input type\n  if ('hex' === inputType) {\n    reader.readAsArrayBuffer(file);\n  } else {\n    reader.readAsText(file);\n  }\n  reader.onload = e => {\n    const pass = CryptoJS.enc.Utf8.parse(password);\n    let cipherText;\n\n    // Render cipher text based on input type\n    if ('hex' === inputType) {\n      cipherText = CryptoJS.lib.WordArray.create(e.target.result);\n    } else {\n      cipherText = e.target.result;\n    }\n\n    // Decrypted file\n    let decrypted = getDecryptedOutput({\n      cipherText: cipherText,\n      pass: pass,\n      type: inputType\n    });\n\n    // Filter output based on input type\n    let output = filterOutput(decrypted, inputType);\n    const blob = new Blob([output], {\n      type: 'application/octet-stream'\n    });\n\n    let blobUrl = URL.createObjectURL(blob);\n    download(file.name, blobUrl);\n  };\n}\n\n/**\n * Trigger file download\n * @param {String} name File name\n * @param {String} url URL\n */\nfunction download(name, url) {\n  const anchor = document.getElementById('download');\n  anchor.href = url;\n  anchor.download = name;\n  anchor.click();\n}\n\n/**\n * Decrypt cipher text\n * @param {*} args Object with arguments\n * @return {*} Object\n */\nfunction getDecryptedOutput(args) {\n  let decrypted;\n  if ('hex' === args.type) {\n    decrypted = CryptoJS.AES.decrypt({\n      ciphertext: args.cipherText\n    },\n    args.pass, {\n      iv: args.pass,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7\n    });\n  } else {\n    decrypted = CryptoJS.AES.decrypt(args.cipherText, args.pass, {\n      iv: args.pass,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7\n    });\n  }\n  return decrypted;\n}\n\n/**\n * Filter output based on type\n * @param {*} decrypted Decryptor\n * @param {*} type Input type\n * @return {*} String\n */\nfunction filterOutput(decrypted, type) {\n  let output;\n  switch (type) {\n    case 'hex':\n      output = reorganizeHexValues(decrypted.toString(CryptoJS.enc.Hex));\n      break;\n    case 'b64':\n      output = decrypted.toString(CryptoJS.enc.Base64);\n      break;\n    case 'utf-8':\n      output = decrypted.toString(CryptoJS.enc.Utf8);\n      break;\n    default:\n      output = decrypted.toString();\n  }\n  return output;\n}\n\n/**\n * Reorganize hex values to correct format\n * @param {String} values String\n * @return {String} organized hex values\n */\nfunction reorganizeHexValues(values) {\n  let output = '';\n  let columnCount = 0;\n  for (let i = 0; i < values.length; i += 4) {\n    columnCount++;\n    output += values[i] + values[i + 1] + values[i + 2] + values[i + 3];\n    if (columnCount === 8) {\n      columnCount = 0;\n      output += '\\n';\n    } else {\n      output += ' ';\n    }\n  }\n  return output;\n}\n\n(function() {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n      // [::1] is the IPv6 localhost address.\n      window.location.hostname === '[::1]' ||\n      // 127.0.0.1/8 is considered localhost for IPv4.\n      window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n      )\n    );\n\n  if ('serviceWorker' in navigator &&\n      (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n    .then(function(registration) {\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function() {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          var installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function() {\n            switch (installingWorker.state) {\n              case 'installed':\n                // At this point, the old content will have been purged and the\n                // fresh content will have been added to the cache.\n                // It's the perfect time to display a \"New content is\n                // available; please refresh.\" message in the page's interface.\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' +\n                                'service worker became redundant.');\n\n              default:\n                // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function(e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n  const fileUpload = document.getElementById('file-upload');\n  const fileName = document.getElementById('file-name');\n  const password = document.getElementById('password');\n  const btnDecrypt = document.getElementById('btn-decrypt');\n\n  fileUpload.addEventListener('change', () => {\n    fileName.value = fileUpload.files[0].name;\n  });\n\n  btnDecrypt.addEventListener('click', e => {\n    e.preventDefault();\n\n    if (!fileUpload.files[0]) {\n      displayToast('Please select a file.');\n      return;\n    }\n    if (!password.value) {\n      displayToast('Please enter a password.');\n      return;\n    }\n    const file = fileUpload.files[0];\n    fileName.value = file.name;\n\n    decryptFile(file, password.value);\n  });\n})();\n"]}